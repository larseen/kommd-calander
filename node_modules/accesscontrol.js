/**
 * Created by Sondre on 14.08.2014.
 */

function accesscontrol(params){

    var config = params.config;
    /*
     * accesscontrol - handles http access control based on configuration
     */
    accesscontrol.handle = function(req, res, next) {

        if (req.header('Origin')) {
            if (config.get('accessControl:allowOrigin')) {
                res.header('Access-Control-Allow-Origin', config.get('accessControl:allowOrigin'));
            }
            if (config.get('accessControl:allowMethods')) {
                res.header('Access-Control-Allow-Methods', config.get('accessControl:allowMethods'));
            }
            if (req.header('Access-Control-Request-Headers')) {
                res.header('Access-Control-Allow-Headers', req.header('Access-Control-Request-Headers'));
            }
        }
        return next();
    };
    return accesscontrol;
};

module.exports = accesscontrol;
